version: "2.1"
dependencies:
  - project: apache/drools
    mapping:
      dependencies:
        default:
          - source: (\d*)\.(.*)
            targetExpression: "process.env.GITHUB_BASE_REF.replace(/(\\d*)\\.(.*)/g, (m, n1, n2) => `${+n1-7}.${n2}`)"
      dependant:
        default:
          - source: (\d*)\.(.*)
            targetExpression: "process.env.GITHUB_BASE_REF.replace(/(\\d*)\\.(.*)/g, (m, n1, n2) => `${+n1+7}.${n2}`)"
      exclude:
        - apache/kie-jpmml-integration

  - project: apache/kogito-runtimes
    dependencies:
      - project: apache/drools
    mapping:
      dependencies:
        default:
          - source: (\d*)\.(.*)
            targetExpression: "process.env.GITHUB_BASE_REF.replace(/(\\d*)\\.(.*)/g, (m, n1, n2) => `${+n1+7}.${n2}`)"
      dependant:
        default:
          - source: (\d*)\.(.*)
            targetExpression: "process.env.GITHUB_BASE_REF.replace(/(\\d*)\\.(.*)/g, (m, n1, n2) => `${+n1-7}.${n2}`)"
      exclude:
        - apache/kogito-examples
        - apache/kogito-apps
  
  - project: apache/kogito-apps
    dependencies:
      - project: apache/kogito-runtimes
    mapping:
      dependencies:
        default:
          - source: (\d*)\.(.*)
            targetExpression: "process.env.GITHUB_BASE_REF.replace(/(\\d*)\\.(.*)/g, (m, n1, n2) => `${+n1+7}.${n2}`)"
      dependant:
        default:
          - source: (\d*)\.(.*)
            targetExpression: "process.env.GITHUB_BASE_REF.replace(/(\\d*)\\.(.*)/g, (m, n1, n2) => `${+n1-7}.${n2}`)"
      exclude:
        - apache/kogito-examples
        - apache/kogito-runtimes

  - project: apache/kogito-examples
    dependencies:
      - project: apache/kogito-runtimes
      - project: apache/kogito-apps
    mapping:
      dependencies:
        default:
          - source: (\d*)\.(.*)
            targetExpression: "process.env.GITHUB_BASE_REF.replace(/(\\d*)\\.(.*)/g, (m, n1, n2) => `${+n1+7}.${n2}`)"
      dependant:
        default:
          - source: (\d*)\.(.*)
            targetExpression: "process.env.GITHUB_BASE_REF.replace(/(\\d*)\\.(.*)/g, (m, n1, n2) => `${+n1-7}.${n2}`)"
      exclude:
        - apache/kogito-apps
        - apache/kogito-runtimes
  
  - project: apache/kie-jpmml-integration
    dependencies:
      - project: apache/drools
    # no mapping needed
