<?xml version="1.0" encoding="UTF-8"?>
<section version="5.0"
         xsi:schemaLocation="http://docbook.org/ns/docbook http://www.docbook.org/xml/5.0/xsd/docbook.xsd http://www.w3.org/1999/xlink http://www.docbook.org/xml/5.0/xsd/xlink.xsd"
         xml:base="../" xmlns="http://docbook.org/ns/docbook" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xlink="http://www.w3.org/1999/xlink"
         xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:ns="http://docbook.org/ns/docbook"
         xml:id="remote.java.api">

  <title>Remote Java API</title>
  
    <para>The Remote Java API provides <code>KieSession</code>, <code>TaskService</code> and
        <code>AuditService</code> interfaces to the JMS and REST APIs.</para>
    
    <para>The interface implementations provided by the Remote Java API take care of the underlying
      logic needed to communicate with the JMS or REST APIs. In other words, these implementations
      will allow you to interact with a remote workbench instance (i.e. KIE workbench or the jBPM
      Console) via known interfaces such as the <code>KieSession</code> or <code>TaskService</code> interface, 
      without having to deal with the underlying transport and serialization details.</para>
    
  <important>
    <title>The Remote Java API provides clients, not "instances"</title>
    <para>While the <code>KieSession</code>, <code>TaskSerivce</code> and
        <code>AuditService</code> instances provided by the Remote Java API may "look" and "feel"
      like local instances of the same interfaces, please make sure to remember that these instances
      are only wrappers around a REST or jMS client that interacts with a remote REST or JMS
      API.</para>
    <blockquote> <!-- necessary in order to insert a space here --> </blockquote>
    <para>This means that if a requested operation fails on the <emphasis>server</emphasis>, the
      Remote Java API client instance on the <emphasis>client</emphasis> side will throw a
        <code>RuntimeException</code> indicating that the REST call failed. This is different from
      the behaviour of a "real" (or local) instance of a <code>KieSession</code>,
        <code>TaskSerivce</code> and <code>AuditService</code> instance because the exception the
      local instances will throw will relate to how the operation failed. Also, while local
      instances require different handling (such as having to dispose of a <code>KieSession</code>),
      client instances provided by the Remote Java API hold no state and thus do not require any
      special handling.</para>
    <blockquote> <!-- necessary in order to insert a space here --> </blockquote>
    <para>Lastly, operations on a Remote Java API client instance that would normally throw other
      exceptions (such as the <code>TaskService.claim(taskId, userId)</code> operation when called
      by a user who is not a potential owner), will now throw a <code>RuntimeException</code>
      instead when the requested operation fails on the <emphasis>server</emphasis>.</para>
  </important>
   
  <para>The first step in interacting with the remote runtime is to create either the
      <code>RemoteRestRuntimeFactory</code> or <code>RemoteJmsRuntimeEngineFactory</code>, both of
    which are instances of the <code>RemoteRuntimeEngineFactory</code> interface.</para>
  
  <para>The configuration for the Remote Java API is done when creating the
      <code>RemoteRuntimeEngineFactory</code> instance: there are a number of different constructors
    for both the JMS and REST impelementations that allow the configuration of such things as the
    base URL of the REST API, JMS queue location or timeout while waiting for responses. </para>
  
  <para>Once the factory instances have been created, there are a couple of methods that can then be
    used to instantiate the client instance that you want to use: <variablelist>
      <title>Remote Java API Methods</title>
      <varlistentry>
        <term><command>RemoteRuntimeEngine
          RemoteRuntimeEngineFactory.newRuntimeEngine()</command></term>
        <listitem>
          <para>This method instantiates a new <command>RemoteRuntimeEngine</command> (client)
            instance.</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term><command>RemoteRuntimeEngineFactory.addExtraJaxbClasses(Collection&lt;Class&lt;?&gt;&gt;
            extraJaxbClasses )</command></term>
        <listitem>
          <para>This method adds extra classes to the classpath available to the serialization
            mechanisms.</para>
          <para>When passing instances of user-defined classes in a Remote Java API call, it's
            important to have added the classes via this method first so that the class instances
            can be serialized correctly.</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term><command>KieSession RemoteRuntimeEngine.getKieSession()</command></term>
        <listitem>
          <para>This method instantiates a new (client) <command>KieSession</command>
            instance.</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term><command>TaskService RemoteRuntimeEngine.getTaskService()</command></term>
        <listitem>
          <para>This method instantiates a new (client) <command>TaskService</command>
            instance.</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term><command>AuditService RemoteRuntimeEngine.getAuditService()</command></term>
        <listitem>
          <para>This method instantiates a new (client) <command>AuditService</command>
            instance.</para>
        </listitem>
      </varlistentry>
    </variablelist>
  </para>
  
    <section xml:id="remote.java.api.rest">
      <title>The REST Remote Java RuntimeEngine Factory</title>     
      <note>
        <title>Oops!</title>
        <para>The <code>RemoteRestRuntimeFactory</code> should indeed have been called the
            <code>RemoteRestRuntime<emphasis>Engine</emphasis>Factory</code>! Sometimes it's the
        easiest mistakes which are the hardest to catch. This will be corrected in future
        releases.</para>
      </note>
      
      <para>The <code>RemoteRestRuntimeFactory</code> has 4 constructor methods available. Besides
      an "everything" constructor method which provides all of the options provided below, there are
      also the following 3 constructors:</para>
      
      <para>
        <variablelist>
          <title>RemoteRestRuntimeFactory constructor method parameters</title>
          <varlistentry>
            <term>Simple constructor</term>
            <listitem>
              <table frame="all">
                <title>Simple <command>RemoteRestRuntimeFactory</command> constructor parameters</title>
                <tgroup cols="3" align="left" rowsep="1" colsep="1">
                  <thead valign="top">
                    <row>
                      <entry>Name</entry>
                      <entry>Type</entry>
                      <entry>Description</entry>
                    </row>
                  </thead>
                  <tbody valign="top">
                    <row>
                      <entry><para><code>deploymentId</code></para></entry>
                      <entry><para><code>java.lang.String</code></para></entry>
                      <entry>
                        <para>This is the name (id) of the deployment the <code>RuntimeEngine</code>
                          should interact with.</para>
                      </entry>
                    </row>
                    <row>
                      <entry><para><code>baseUrl</code></para></entry>
                      <entry><para><code>java.net.URL</code></para></entry>
                      <entry>
                        <para>This is the URL of the deployed jbpm-console, kie-wb or BPMS instance.</para>
                        <para>For example: <code>http://127.0.0.1:8080/jbpm-console/</code></para>
                      </entry>
                    </row>
                    <row>
                      <entry><para><code>username</code></para></entry>
                      <entry><para><code>java.lang.String</code></para></entry>
                      <entry>
                        <para>This is the user name needed to access the JMS queues.</para>
                      </entry>
                    </row>
                    <row>
                      <entry><para><code>password</code></para></entry>
                      <entry><para><code>java.lang.String</code></para></entry>
                      <entry>
                        <para>This is the password needed to access the JMS queues.</para>
                      </entry>
                    </row>
                  </tbody>
                </tgroup>
              </table>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>Constructor with timeout parameter</term>
            <listitem>
              <table frame="all">
                <title><command>RemoteRestRuntimeFactory</command> constructor parameters with (response message) timeout parameter</title>
                <tgroup cols="3" align="left" rowsep="1" colsep="1">
                  <thead valign="top">
                    <row>
                      <entry>Name</entry>
                      <entry>Type</entry>
                      <entry>Description</entry>
                    </row>
                  </thead>
                  <tbody valign="top">
                    <row>
                      <entry><para><code>deploymentId</code></para></entry>
                      <entry><para><code>java.lang.String</code></para></entry>
                      <entry>
                        <para>This is the name (id) of the deployment the <code>RuntimeEngine</code>
                          should interact with.</para>
                      </entry>
                    </row>
                    <row>
                      <entry><para><code>baseUrl</code></para></entry>
                      <entry><para><code>java.net.URL</code></para></entry>
                      <entry>
                        <para>This is the URL of the deployed jbpm-console, kie-wb or BPMS instance.</para>
                        <para>For example: <code>http://127.0.0.1:8080/jbpm-console/</code></para>
                      </entry>
                    </row>
                    <row>
                      <entry><para><code>username</code></para></entry>
                      <entry><para><code>java.lang.String</code></para></entry>
                      <entry>
                        <para>This is the user name needed to access the REST API.</para>
                      </entry>
                    </row>
                    <row>
                      <entry><para><code>password</code></para></entry>
                      <entry><para><code>java.lang.String</code></para></entry>
                      <entry>
                        <para>This is the password needed to access the REST API.</para>
                      </entry>
                    </row>
                    <row>
                      <entry><para><code>timeoutInSeconds</code></para></entry>
                      <entry><para><code>int</code></para></entry>
                      <entry>
                        <para>This maximum number of seconds to wait when waiting for a response from the server.</para>
                      </entry>
                    </row>
                  </tbody>
                </tgroup>
              </table>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term>Constructor with form-based authorization parameter</term>
            <listitem>
              <table frame="all">
                <title><command>RemoteRestRuntimeFactory</command> constructor parameters with form-based authorization parameter</title>
                <tgroup cols="3" align="left" rowsep="1" colsep="1">
                  <thead valign="top">
                    <row>
                      <entry>Name</entry>
                      <entry>Type</entry>
                      <entry>Description</entry>
                    </row>
                  </thead>
                  <tbody valign="top">
                    <row>
                      <entry><para><code>deploymentId</code></para></entry>
                      <entry><para><code>java.lang.String</code></para></entry>
                      <entry>
                        <para>This is the name (id) of the deployment the <code>RuntimeEngine</code>
                          should interact with.</para>
                      </entry>
                    </row>
                    <row>
                      <entry><para><code>baseUrl</code></para></entry>
                      <entry><para><code>java.net.URL</code></para></entry>
                      <entry>
                        <para>This is the URL of the deployed jbpm-console, kie-wb or BPMS instance.</para>
                        <para>For example: <code>http://127.0.0.1:8080/jbpm-console/</code></para>
                      </entry>
                    </row>
                    <row>
                      <entry><para><code>username</code></para></entry>
                      <entry><para><code>java.lang.String</code></para></entry>
                      <entry>
                        <para>This is the user name needed to access the REST API.</para>
                      </entry>
                    </row>
                    <row>
                      <entry><para><code>password</code></para></entry>
                      <entry><para><code>java.lang.String</code></para></entry>
                      <entry>
                        <para>This is the password needed to access the REST API.</para>
                      </entry>
                    </row>
                    <row>
                      <entry><para><code>useFormBasedAuth</code></para></entry>
                      <entry><para><code>boolean</code></para></entry>
                      <entry>
                        <para>Whether or not to use form-based authentication when making a REST call. Form-based authentication will be necessary on tomcat instances.</para>
                      </entry>
                    </row>
                  </tbody>
                </tgroup>
              </table>
            </listitem>
          </varlistentry>
        </variablelist>
      </para>
      <section>
        <title>Example usage</title>
          <para>The following example illustrates how the Remote Java API can be used with the REST API.</para>
      
      <programlisting language="java"><![CDATA[public void startProcessAndHandleTaskViaRestRemoteJavaAPI(URL instanceUrl, String deploymentId, String user, String password) {
  // the serverRestUrl should contain a URL similar to "http://localhost:8080/jbpm-console/"
  
  // Setup the factory class with the necessarry information to communicate with the REST services
  RemoteRuntimeEngineFactory restSessionFactory 
    = new RemoteRestRuntimeFactory(deploymentId, instanceUrl, user, password);

  // Create KieSession and TaskService instances and use them
  RemoteRuntimeEngine engine = restSessionFactory.newRuntimeEngine();
  KieSession ksession = engine.getKieSession();
  TaskService taskService = engine.getTaskService();

  // Each opertion on a KieSession, TaskService or AuditService (client) instance 
  // sends a request for the operation to the server side and waits for the response
  // If something goes wrong on the server side, the client will throw an exception. 
  ProcessInstance processInstance 
    = ksession.startProcess("com.burns.reactor.maintenance.cycle");
  long procId = processInstance.getId();

  String taskUserId = user;
  taskService = engine.getTaskService();
  List<TaskSummary> tasks = taskService.getTasksAssignedAsPotentialOwner(user, "en-UK");

  long taskId = -1;
  for (TaskSummary task : tasks) {
    if (task.getProcessInstanceId() == procId) {
      taskId = task.getId();
    }
  }

  if (taskId == -1) {
    throw new IllegalStateException("Unable to find task for " + user + " in process instance " + procId);
  }

  taskService.start(taskId, taskUserId);
}
]]></programlisting>
    </section>
     
     <!-- finish this.. 
    <section>
      <title>Remote REST Java API exceptions</title>
      
      <para>Because the Remote REST Java API clients implement the existing <code>KieSession</code>,
          <code>TaskService</code> and <code>AuditService</code> interfaces, the exceptions
        thrown by the client implementations must be instances of a
        <code>RuntimeException</code>.</para>
      
      <para>The table below lists the exceptions thrown by the different client interfaces.</para>
      
      <table frame="all">
        <title>Exceptions thrown by the Remote REST Java API client implementations</title>
        <tgroup cols="3" align="left" rowsep="1" colsep="1">
          <thead valign="top">
            <row>
              <entry>Name</entry>
              <entry>Description</entry>
            </row>
          </thead>
          <tbody valign="top">
            <row>
              <entry><para><code>deploymentId</code></para></entry>
              <entry><para><code>java.lang.String</code></para></entry>
              <entry>
                <para>This is the name (id) of the deployment the <code>RuntimeEngine</code>
                  should interact with.</para>
              </entry>
            </row>
            <row>
              <entry><para><code>baseUrl</code></para></entry>
              <entry><para><code>java.net.URL</code></para></entry>
              <entry>
                <para>This is the URL of the deployed jbpm-console, kie-wb or BPMS instance.</para>
                <para>For example: <code>http://127.0.0.1:8080/jbpm-console/</code></para>
              </entry>
            </row>
            <row>
              <entry><para><code>username</code></para></entry>
              <entry><para><code>java.lang.String</code></para></entry>
              <entry>
                <para>This is the user name needed to access the REST API.</para>
              </entry>
            </row>
            <row>
              <entry><para><code>password</code></para></entry>
              <entry><para><code>java.lang.String</code></para></entry>
              <entry>
                <para>This is the password needed to access the REST API.</para>
              </entry>
            </row>
            <row>
              <entry><para><code>timeoutInSeconds</code></para></entry>
              <entry><para><code>int</code></para></entry>
              <entry>
                <para>This maximum number of seconds to wait when waiting for a response from the server.</para>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      
    </section>
    -->
    </section>
         
    <section xml:id="remote.java.api.jms">
      <title>The JMS Remote Java RuntimeEngine Factory</title>
      
      <para>The Remote JMS Java RuntimeEngine works precisely the same as the REST variant, except
        that it has different constructors.</para>
      
      <para>The <code>RemoteJmsRuntimeEngineFactory</code> constructors can be grouped into 3 types.
      The list below specifies the main arguments to each group type. <orderedlist>
        <listitem>
          <para>The URL of the execution server instance is given</para>
        </listitem>
        <listitem>
          <para>The JMS remote access objects (such as the <code>ConnectionFactory</code> and
              <code>Queue</code>) are given.</para>
        </listitem>
        <listitem>
          <para>A remote <code>InitialContext</code> instance (created using JNDI) from the server
            is given.</para>
        </listitem>
      </orderedlist></para>
      
      <formalpara>
        <title>Configuration using the server <code>URL</code></title>
        
        <para>Configuration using only the URL of the server where the jBPM Console or Kie Workbench
        instance is running, is the most straightforward. However, this is only possible when the
        jBPM console or KIE Workbench instance is running on Wildfly or JBoss AS, or JBoss EAP. </para>
      </formalpara>
      
      <para> The following table describes the parameters used when using an
        <code>InitialContext</code> to configure a <code>RemoteJmsRuntimeEngineFactory</code>
        instance: <table frame="all">
          <title>RemoteJmsRuntimeFactory constructor arguments</title>
          <tgroup cols="3" align="left" rowsep="1" colsep="1">
            <thead valign="top">
              <row>
                <entry>Name</entry>
                <entry>Type</entry>
                <entry>Description</entry>
              </row>
            </thead>
            <tbody valign="top">
              <row>
                <entry><para><code>deploymentId</code></para></entry>
                <entry><para><code>java.lang.String</code></para></entry>
                <entry>
                  <para>This is the name (id) of the deployment the <code>RuntimeEngine</code>
                    should interact with.</para>
                </entry>
              </row>
              <row>
                <entry><para><code>serverURL</code></para></entry>
                <entry><para><code>java.net.URL</code></para></entry>
                <entry>
                  <para>This is the URL of the (JBoss) server instance..</para>
                </entry>
              </row>
              <row>
                <entry><para><code>username</code></para></entry>
                <entry><para><code>java.lang.String</code></para></entry>
                <entry>
                  <para>This is the user name needed to access the JMS queues and JNDI
                    InitialContext instance. </para>
                </entry>
              </row>
              <row>
                <entry><para><code>password</code></para></entry>
                <entry><para><code>java.lang.String</code></para></entry>
                <entry>
                  <para>This is the password needed to access the JMS queues and JNDI InitialContext
                    instance. </para>
                </entry>
              </row>
            </tbody>
          </tgroup>
        </table>
      </para>
      
      <formalpara>
        <title>Configuration using an <code>InitialContext</code> instance</title>
        
        <para>When configuring the <code>RemoteJmsRuntimeEngineFactory</code> with an
          <code>InitialContext</code> instance as a parameter, it's necessary to retrieve the
          (remote) <code>InitialContext</code> instance first from the remote server. The following
          code illustrates how to do this. </para>
        
      
      </formalpara>
      
      <important>
        <para>The code below illustrates how this can be done with a <emphasis>JBoss AS 7 or EAP
          6</emphasis> server instance. Similar code is used in the constructor above.</para>
        <blockquote> <!-- necessary in order to insert a space here --> </blockquote>
        <para>However, regardless of which application server you use, it is necessary to
          include in your classpath the class specified as the <code>INITIAL_CONTEXT_FACTORY</code>
          (see below). For JBoss AS 7 and EAP 6, the artifact (jar) containing this class is the
            <code>org.jboss:jboss-remote-naming</code> artifact (jar), version
            <code>1.0.5.Final</code> or higher. Depending on the version of AS 7 or EAP 6 that you
          use, this version may vary.</para>
        <blockquote> <!-- necessary in order to insert a space here --> </blockquote>
        <para>If you are using a <emphasis>different</emphasis> application server, please see your specific
          application server documentation for the parameters and artifacts necessary to create an
            <code>InitialContextFactory</code> instance or otherwise get a remote
            <code>InitialContext</code> instance (via JNDI) from the application server instance.</para>
      </important>
      
      <programlisting language="java"><![CDATA[public void startProcessAndTaskViaJmsRemoteJavaAPI(String serverHostName, String deploymentId, String user, String password) {
  // Setup remote JMS runtime engine factory
  InitialContext remoteInitialContext 
    = getRemoteInitialContext(serverHostName, user, password);
  int maxTimeoutSecs = 5;
  RemoteJmsRuntimeEngineFactory remoteJmsFactory 
    = new RemoteJmsRuntimeEngineFactory(deploymentId, remoteInitialContext, user, password, maxTimeoutSecs);

  // Interface with JMS api
  RuntimeEngine engine = remoteJmsFactory.newRuntimeEngine();
  KieSession ksession = engine.getKieSession();
  ProcessInstance processInstance = ksession.startProcess("com.burns.reactor.maintenance.cycle");
  long procId = processInstance.getId();
  TaskService taskService = engine.getTaskService();
  List<Long> tasks = taskService.getTasksByProcessInstanceId(procId);
  taskService.start(tasks.get(0), user);
}

private static InitialContext getRemoteInitialContext(String jbossServerHostName, String user, String password) { 
  // Configure the (JBoss AS 7/EAP 6) InitialContextFactory
  Properties initialProps = new Properties();
  initialProps.setProperty(InitialContext.INITIAL_CONTEXT_FACTORY, "org.jboss.naming.remote.client.InitialContextFactory");
  initialProps.setProperty(InitialContext.PROVIDER_URL, "remote://"+ jbossServerHostName + ":4447");
  initialProps.setProperty(InitialContext.SECURITY_PRINCIPAL, user);
  initialProps.setProperty(InitialContext.SECURITY_CREDENTIALS, password);

  for (Object keyObj : initialProps.keySet()) {
    String key = (String) keyObj;
    System.setProperty(key, (String) initialProps.get(key));
  }
  
  // Create the remote InitialContext instance
  try {
    return new InitialContext(initialProps);
  } catch (NamingException e) {
    throw new RuntimeException("Unable to create " + InitialContext.class.getSimpleName(), e);
  }
}]]></programlisting>
      
      <para> The following table describes the parameters used when using an
        <code>InitialContext</code> to configure a <code>RemoteJmsRuntimeEngineFactory</code>
      instance: <table frame="all">
        <title>RemoteJmsRuntimeFactory constructor arguments</title>
        <tgroup cols="3" align="left" rowsep="1" colsep="1">
          <thead valign="top">
            <row>
              <entry>Name</entry>
              <entry>Type</entry>
              <entry>Description</entry>
            </row>
          </thead>
          <tbody valign="top">
            <row>
              <entry><para><code>deploymentId</code></para></entry>
              <entry><para><code>java.lang.String</code></para></entry>
              <entry>
                <para>This is the name (id) of the deployment the <code>RuntimeEngine</code> should
                  interact with.</para>
              </entry>
            </row>
            <row>
              <entry><para><code>initialContext</code></para></entry>
              <entry><para><code>javax.naming.InitialContext</code></para></entry>
              <entry>
                <para>This is a remote <code>InitialContext</code> instance from which the
                    (<code>javax.jms</code>) <code>ConnectionFactory</code> and <code>Queue</code>
                  instances can be retrieved.</para>
              </entry>
            </row>
            <row>
              <entry><para><code>username</code></para></entry>
              <entry><para><code>java.lang.String</code></para></entry>
              <entry>
                <para>This is the user name needed to access the JMS queues.</para>
              </entry>
            </row>
            <row>
              <entry><para><code>password</code></para></entry>
              <entry><para><code>java.lang.String</code></para></entry>
              <entry>
                <para>This is the password needed to access the JMS queues.</para>
              </entry>
            </row>
            <row>
              <entry><para><code>timeoutSeconds</code></para></entry>
              <entry><para><code>int</code></para></entry>
              <entry>
                <para>This maximum number of seconds to wait when waiting for a response from
                  the server.</para>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </table></para>

      <formalpara>
        <title>Configuration using <code>ConnectionFactory</code> and <code>Queue</code> instance parameters</title>
        <para>Some users may have direct access to a <code>ConnectionFactory</code> and the
          <code>Queue</code> instances needed to interact with the JMS API. In this case, they can
        use the <code>RemoteJmsRuntimeEngineFactory</code> constructor that uses the following
        arguments: <table frame="all">
          <title>RemoteJmsRuntimeEngineFactory constructor arguments</title>
          <tgroup cols="3" align="left" rowsep="1" colsep="1">
            <thead valign="top">
              <row>
                <entry>Name</entry>
                <entry>Type</entry>
                <entry>Description</entry>
              </row>
            </thead>
            <tbody valign="top">
              <row>
                <entry><para><code>deploymentId</code></para></entry>
                <entry><para><code>java.lang.String</code></para></entry>
                <entry>
                  <para>This is the name (id) of the deployment the <code>RuntimeEngine</code>
                    should interact with.</para>
                </entry>
              </row>
              <row>
                <entry><para><code>connectionFactory</code></para></entry>
                <entry><para><code>javax.jms.ConnectionFactory</code></para></entry>
                <entry>
                  <para>This is a <code>ConnectionFactory</code> instance used to connect to the
                      <code>ksessionQueue</code> or <code>taskQueue</code>.</para>
                </entry>
              </row>
              <row>
                <entry><para><code>ksessionQueue</code></para></entry>
                <entry><para><code>javax.jms.Queue</code></para></entry>
                <entry>
                  <para>This is an instance of the <code>Queue</code> for requests relating to the
                    process instance.</para>
                </entry>
              </row>
              <row>
                <entry><para><code>taskQueue</code></para></entry>
                <entry><para><code>javax.jms.Queue</code></para></entry>
                <entry>
                  <para>This is an instance of the <code>Queue</code> for requests relating to task
                    service usage.</para>
                </entry>
              </row>
              <row>
                <entry><para><code>responseQueue</code></para></entry>
                <entry><para><code>javax.jms.Queue</code></para></entry>
                <entry>
                  <para>This is an instance of the <code>Queue</code> used to receive
                    responses.</para>
                </entry>
              </row>
              <row>
                <entry><para><code>username</code></para></entry>
                <entry><para><code>java.lang.String</code></para></entry>
                <entry>
                  <para>This is the user name needed to access the JMS queues (in your application
                    server configuration).</para>
                </entry>
              </row>
              <row>
                <entry><para><code>password</code></para></entry>
                <entry><para><code>java.lang.String</code></para></entry>
                <entry>
                  <para>This is the password needed to access the JMS queues (in your application
                    server configuration).</para>
                </entry>
              </row>
              <row>
                <entry><para><code>timeoutSeconds</code></para></entry>
                <entry><para><code>int</code></para></entry>
                <entry>
                  <para>This maximum number of seconds to wait when waiting for a response from
                    the server.</para>
                </entry>
              </row>
            </tbody>
          </tgroup>
        </table>
      </para>
      </formalpara>
    </section>

  <section xml:id="remote.java.api.supported">
    <title>Supported methods</title>
    
    <para>As mentioned above, the Remote Java API provides client-like instances of the <code>RuntimeEngine</code>, <code>KieSession</code>,
      <code>TaskService</code> and <code>AuditService</code> interfaces.</para>
    
    <para>This means that while many of the methods in those interfaces are available, some are not. The following tables lists the methods
      which are available. Methods not listed in the below, will throw an <code>UnsupportedOperationException</code> explaining that the 
      called method is not available.
    
    <table frame="all">
      <title>Available process-related <code>KieSession</code> methods</title>
      <tgroup cols="3" align="left" rowsep="1" colsep="1">
        <thead valign="top">
          <row>
            <entry>Returns</entry>
            <entry>Method signature</entry>
            <entry>Description</entry>
          </row>
        </thead>
        <tbody valign="top">
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><literallayout><code>abortProcessInstance(long processInstanceId)</code></literallayout></entry>
            <entry><para>Abort the process instance</para></entry>
          </row>
          <row>
            <entry><para><code>ProcessInstance</code></para></entry>
            <entry><para><code>getProcessInstance(long processInstanceId)</code></para></entry>
            <entry><para>Return the process instance</para></entry>
          </row>
          <row>
            <entry><para><code>ProcessInstance</code></para></entry>
            <entry>
              <literallayout><code>getProcessInstance(long processInstanceId,</code>
  <code>boolean readOnly)</code></literallayout>
            </entry>
            <entry><para>Return the process instance</para></entry>
          </row>
          <row>
            <entry><para><code>List&lt;ProcessInstance&gt;</code></para></entry>
            <entry><para><code>getProcessInstances()</code></para></entry>
            <entry><para>Return all (active) process instances</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><para><code>signalEvent(String signal, Object event)</code></para></entry>
            <entry><para>Signal all (active) process instances</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry>
              <literallayout><code>signalEvent(String signal, Object event,</code>
  <code>long processInstanceId)</code></literallayout>
            </entry>
            <entry><para>Signal the process instance</para></entry>
          </row>
          <row>
            <entry><para><code>ProcessInstance</code></para></entry>
            <entry>
              <literallayout><code>startProcess(String processId,</code>
  <code>CorrelationKey correlationKey,</code>
  <code>Map&lt;String, Object&gt; parameters)</code></literallayout>
            </entry>
            <entry><para>Start a new process and return the process instance (if the process instance has not immediately completed)</para></entry>
          </row>
          <row>
            <entry><para><code>ProcessInstance</code></para></entry>
            <entry>
              <literallayout><code>startProcess(String processId,</code>
  <code>Map&lt;String, Object&gt; parameters);</code></literallayout>
            </entry>
            <entry><para>Start a new process and return the process instance (if the process instance has not immediately completed)</para></entry>
          </row>
        </tbody>
      </tgroup>
    </table>

    <table frame="all">
      <title>Available rules-related <code>KieSession</code> methods</title>
      <tgroup cols="3" align="left" rowsep="1" colsep="1">
        <thead valign="top">
          <row>
            <entry>Returns</entry>
            <entry>Method signature</entry>
            <entry>Description</entry>
          </row>
        </thead>
        <tbody valign="top">
          <row>
            <entry><para><code>Long</code></para></entry>
            <entry><para><code>getFactCount()</code></para></entry>
            <entry><para>Return the total fact count</para></entry>
          </row>
          <row>
            <entry><para><code>Object</code></para></entry>
            <entry><para><code>getGlobal(String identifier)</code></para></entry>
            <entry><para>Return a global fact</para></entry>
          </row>
          <row>
            <entry><para><code>Integer</code></para></entry>
            <entry><para><code>getId()</code></para></entry>
            <entry><para>Return the id of the <code>KieSession</code></para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><para><code>setGlobal(String identifier, Object value)</code></para></entry>
            <entry><para>Set a global fact</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><para><code>fireAllRules()</code></para></entry>
            <entry><para>Fire all rules</para></entry>
          </row>
        </tbody>
      </tgroup>
    </table>

    <table frame="all">
      <title>Available <code>WorkItemManager</code> methods</title>
      <tgroup cols="3" align="left" rowsep="1" colsep="1">
        <thead valign="top">
          <row>
            <entry>Returns</entry>
            <entry>Method signature</entry>
            <entry>Description</entry>
          </row>
        </thead>
        <tbody valign="top">
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><para><code>abortWorkItem(long workItemId)</code></para></entry>
            <entry><para>Abort the work item</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><para><code>completeWorkItem(long workItemId, Map&lt;String, Object&gt; results)</code></para></entry>
            <entry><para>Complete the work item</para></entry>
          </row>
          <row>
            <entry><para><code>WorkItem</code></para></entry>
            <entry><para><code>getWorkItem(long workItemId)</code></para></entry>
            <entry><para>Return the work item</para></entry>
          </row>
        </tbody>
      </tgroup>
    </table>
   
    <table frame="all">
      <title>Available task operation <code>TaskService</code> methods</title>
      <tgroup cols="3" align="left" rowsep="1" colsep="1">
        <thead valign="top">
          <row>
            <entry>Returns </entry>
            <entry>Method signature</entry>
            <entry>Description</entry>
          </row>
        </thead>
        <tbody valign="top">
          <row>
            <entry><para><code>Long</code></para></entry>
            <entry><para><code>addTask(Task task, Map&lt;String, Object&gt; params)</code></para></entry>
            <entry><para>Add a new task</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><para><code>activate(long taskId, String userId)</code></para></entry>
            <entry><para>Activate a task</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><para><code>claim(long taskId, String userId)</code></para></entry>
            <entry><para>Claim a task</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><para><code>claim(long taskId, String userId, List&lt;String&gt; groupIds)</code></para></entry>
            <entry><para>Claim a task</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><para><code>claimNextAvailable(String userId, String language)</code></para></entry>
            <entry><para>Claim the next available task for a user</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry>
              <literallayout><code>claimNextAvailable(String userId, List&lt;String&gt; groupIds,</code>
  <code>String language)</code></literallayout>
            </entry>
            <entry><para>Claim the next available task for a user</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry>
              <literallayout><code>complete(long taskId, String userId,</code>
  <code>Map&lt;String, Object&gt; data)</code></literallayout>
            </entry>
            <entry><para>Complete a task</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><para><code>delegate(long taskId, String userId, String targetUserId)</code></para></entry>
            <entry><para>Delegate a task</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><para><code>exit(long taskId, String userId)</code></para></entry>
            <entry><para>Exit a task</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry>
              <literallayout><code>fail(long taskId, String userId, Map&lt;String,</code>
  <code>Object&gt; faultData)</code></literallayout></entry>
            <entry><para>Fail a task</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><para><code>forward(long taskId, String userId, String targetEntityId)</code></para></entry>
            <entry><para>Forward a task</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry>
              <literallayout><code>nominate(long taskId, String userId,</code>
  <code>List&lt;OrganizationalEntity&gt; potentialOwners)</code></literallayout>
            </entry>
            <entry><para>Nominate a task</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><para><code>release(long taskId, String userId)</code></para></entry>
            <entry><para>Release a task</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><para><code>remove(long taskId, String userId)</code></para></entry>
            <entry><para>Remove a task</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><para><code>resume(long taskId, String userId)</code></para></entry>
            <entry><para>Resume a task</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><para><code>skip(long taskId, String userId)</code></para></entry>
            <entry><para>Skip a task</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><para><code>start(long taskId, String userId)</code></para></entry>
            <entry><para>Start a task</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><para><code>stop(long taskId, String userId)</code></para></entry>
            <entry><para>Stop a task</para></entry>
          </row>
          <row>
            <entry><para><code>void</code></para></entry>
            <entry><para><code>suspend(long taskId, String userId)</code></para></entry>
            <entry><para>Suspend a task</para></entry>
          </row>
        </tbody>
      </tgroup>
    </table>
   
    <table frame="all">
      <title>Available task retrieval and query <code>TaskService</code> methods</title>
      <tgroup cols="2" align="left" rowsep="1" colsep="1">
          <colspec colnum="1" colname="c1" colwidth="1*"></colspec>
          <colspec colnum="2" colname="c2" colwidth="3*"></colspec>
        <thead valign="top">
          <row>
            <entry>Returns </entry>
            <entry>Method signature</entry>
          </row>
        </thead>
        <tbody valign="top">
          <row>
            <entry><para><code>Task</code></para></entry>
            <entry><para><code>getTaskByWorkItemId(long workItemId)</code></para></entry>
          </row>
          <row>
            <entry><para><code>Task</code></para></entry>
            <entry><para><code>getTaskById(long taskId)</code></para></entry>
          </row>
          <row>
            <entry><para><code>List&lt;TaskSummary&gt;</code></para></entry>
            <entry>
              <literallayout><code>getTasksAssignedAsBusinessAdministrator(String userId,</code>
  <code>String language)</code></literallayout>
            </entry>
          </row>
          <row>
            <entry><para><code>List&lt;TaskSummary&gt;</code></para></entry>
            <entry>
              <para><code>getTasksAssignedAsPotentialOwner(String userId, String language)</code>
            </para>
            </entry>
          </row>
          <row>
            <entry><para><code>List&lt;TaskSummary&gt;</code></para></entry>
            <entry>
              <literallayout><code>getTasksAssignedAsPotentialOwnerByStatus(String userId,</code>
  <code>List&lt;Status&gt;gt; status, String language)</code></literallayout>
            </entry>
          </row>
          <row>
            <entry><para><code>List&lt;TaskSummary&gt;</code></para></entry>
            <entry><para><code>getTasksOwned(String userId, String language)</code></para></entry>
          </row>
          <row>
            <entry><para><code>List&lt;TaskSummary&gt;</code></para></entry>
            <entry>
              <literallayout><code>getTasksOwnedByStatus(String userId, List&lt;Status&gt; status,</code>
  <code>String language)</code></literallayout>
            </entry>
          </row>
          <row>
            <entry><para><code>List&lt;TaskSummary&gt;</code></para></entry>
            <entry>
              <literallayout><code>getTasksByStatusByProcessInstanceId(long processInstanceId,</code>
  <code>List&lt;Status&gt; status, String language)</code></literallayout>
            </entry>
          </row>
          <row>
            <entry><para><code>List&lt;TaskSummary&gt;</code></para></entry>
            <entry><para><code>getTasksByProcessInstanceId(long processInstanceId)</code></para></entry>
          </row>
          <row>
            <entry><para><code>List&lt;TaskSummary&gt;</code></para></entry>
            <entry>
              <literallayout><code>getTasksByVariousFields(List&lt;Long&gt; workItemIds, List&lt;Long&gt; taskIds,</code>
  <code>List&lt;Long&gt; procInstIds, List&lt;String&gt; busAdmins, </code>
  <code>List&lt;String&gt; potOwners, List&lt;String&gt; taskOwners, List&lt;Status&gt; status,</code> 
  <code>boolean union)</code></literallayout>
            </entry>
          </row>
          <row>
            <entry><para><code>List&lt;TaskSummary&gt;</code></para></entry>
            <entry><para><code>getTasksByVariousFields(Map &lt;String, List&lt;?&gt;&gt; parameters, boolean union)</code></para></entry>
          </row>
          <row>
            <entry><para><code>Content</code></para></entry>
            <entry><para><code>getContentById(long contentId)</code></para></entry>
          </row>
          <row>
            <entry><para><code>Attachment</code></para></entry>
            <entry><para><code>getAttachmentById(long attachId)</code></para></entry>
          </row>
        </tbody>
      </tgroup>
    </table>
    
      <table frame="all">
        <title>Available <code>AuditService</code> methods</title>
        <tgroup cols="2" align="left" rowsep="1" colsep="1">
          <colspec colnum="1" colname="c1" colwidth="1*"></colspec>
          <colspec colnum="2" colname="c2" colwidth="3.55*"></colspec>
          <thead valign="top">
            <row>
              <entry>Returns </entry>
              <entry>Method signature</entry>
            </row>
          </thead>
          <tbody valign="top">
            <row>
              <entry><para><code>List&lt;ProcessInstanceLog&gt;</code></para></entry>
              <entry><para><code>findProcessInstances()</code></para></entry>
            </row>
            <row>
              <entry><para><code>List&lt;ProcessInstanceLog&gt;</code></para></entry>
              <entry><para><code>findProcessInstances(String processId)</code></para></entry>
            </row>
            <row>
              <entry><para><code>List&lt;ProcessInstanceLog&gt;</code></para></entry>
              <entry><para><code>findActiveProcessInstances(String processId)</code></para></entry>
            </row>
            <row>
              <entry><para>ProcessInstanceLog</para></entry>
              <entry><para><code>findProcessInstance(long processInstanceId)</code></para></entry>
            </row>
            <row>
              <entry><para>List&lt;ProcessInstanceLog&gt;</para></entry>
              <entry><para><code>findSubProcessInstances(long processInstanceId)</code></para></entry>
            </row>
            <row>
              <entry><para>List&lt;NodeInstanceLog&gt;</para></entry>
              <entry><para><code>findNodeInstances(long processInstanceId)</code></para></entry>
            </row>
            <row>
              <entry><para>List&lt;NodeInstanceLog&gt;</para></entry>
              <entry><para><code>findNodeInstances(long processInstanceId, String nodeId)</code></para></entry>
            </row>
            <row>
              <entry><para>List&lt;VariableInstanceLog&gt;</para></entry>
              <entry><para><code>findVariableInstances(long processInstanceId)</code></para></entry>
            </row>
            <row>
              <entry><para>List&lt;VariableInstanceLog&gt;</para></entry>
              <entry>
                <literallayout><code>findVariableInstances(long processInstanceId,</code>
  <code>String variableId)</code></literallayout>
              </entry>
            </row>
            <row>
              <entry><para>List&lt;VariableInstanceLog&gt;</para></entry>
              <entry>
                <literallayout><code>findVariableInstancesByName(String variableId,</code>
  <code>boolean onlyActiveProcesses)</code></literallayout>
              </entry>
            </row>
            <row>
              <entry><para>List&lt;VariableInstanceLog&gt;</para></entry>
              <entry><literallayout><code>findVariableInstancesByNameAndValue(String variableId,</code>
  <code>String value, boolean onlyActiveProcesses)</code></literallayout></entry>
            </row>
            <row>
              <entry><para>void</para></entry>
              <entry><para><code>clear()</code></para></entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      
    </para>
    
  </section>
  <!--section>
    <title>REST helper classe</title>
    
    <para>The <code>org.kie.services.client.api.RestRequestHelper</code> class can be used to... </para>
    
    <programlisting language="java">
      asdf
    </programlisting>
  </section-->
</section>
